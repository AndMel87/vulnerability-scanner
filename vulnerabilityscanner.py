#Vulnerability Scanner 2021

#--- Libraries ---
#portscanner is located in same directory, all functions/classes are global
import portscanner

#user prompts
targetIP = input("[+] Enter target IP to scan for open vulnerable ports: ")
portNumber = int(input("[+] Enter the amount of ports you want to scan (500 = 500 first ports): "))
vulnFile = input("[+] Enter path to vulnerabilities-file: ")
print("\n")

#create object and initiate belong to Class
target = portscanner.portScan(targetIP, portNumber)
target.scan()

#open vulnerability file
with open(vulnFile, "r") as file:
    count = 0
    for banner in target.banners:
        file.seek(0)
        for line in file.readlines():
            if line.strip() in banner:
                print("[!!] VULNERABLE BANNER: '" + banner + "' ON PORT: " + str(target.openPorts[count]))
        count += 1
